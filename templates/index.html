{% extends "base.html" %} {% block content %}
<div class="bg-gray-900 min-h-screen flex items-center justify-center p-4">
<div class="max-w-md w-full bg-gray-800 rounded-2xl overflow-hidden shadow-2xl">
  <div class="relative h-48 bg-gradient-to-r from-purple-900 to-indigo-800 flex items-center justify-center">
    <div class="absolute inset-0 bg-black opacity-20"></div>
            <div class="relative z-10 text-center px-6">
                <h1 class="text-3xl font-bold text-white mb-2">Create Account</h1>
            </div>
            <div class="absolute -bottom-6 left-1/2 transform -translate-x-1/2 w-12 h-12 bg-gray-800 rotate-45 rounded"></div>
      </div>
    <form id="loginForm" class="p-8 pt-12" method="POST">

    <div class="input-field relative">
            <input
              class="w-full px-4 py-3 bg-gray-700 border-b-2 border-gray-600 focus:border-purple-500 outline-none text-white rounded-t-lg transition-all duration-300"
              type="email"
              id="email"
              name="email"
              required
            />
            <label class="absolute left-4 top-4 text-md font-bold text-gray-400 pointer-events-none" for="email">Email</label>
            <div class="absolute bottom-0 left-0 w-0 h-0.5 bg-purple-500 transition-all duration-500"></div>
            </div>
            <div class="mt-5 input-field relative">
            <input
              class="w-full px-4 py-3 bg-gray-700 border-b-2 border-gray-600 focus:border-purple-500 outline-none text-white rounded-t-lg transition-all duration-300"
              type="password"
              id="password"
              name="password"
              required
              minlength="8"
            />
            <label class="absolute left-4 top-4 text-md font-bold top-3 text-gray-400 pointer-events-none" for="password">Password</label>
            <div class="absolute bottom-0 left-0 w-0 h-0.5 bg-purple-500 transition-all duration-500"></div>
            </div>

    <button type="submit" class="w-full bg-blue-600 text-white p-3 rounded hover:bg-blue-700 transition mt-10">Login</button>

    <p id="message" class="mt-4 text-center text-red-600"></p>
  </form>
  <div class="text-center text-gray-400">Don't Have a Account ? <a href="{% url 'register' %}" class="text-purple-400 hover:text-purple-300 transition-colors">Register Now</a></div>
  </div>
  <div>
 <script>
  const form = document.getElementById('loginForm');
  const message = document.getElementById('message');

  form.addEventListener('submit', async (e) => {
    e.preventDefault();
    message.textContent = '';

    const data = {
      email: form.email.value,
      password: form.password.value,
    };

    try {
      const response = await fetch('/api/login/', {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify(data),
      });

      if (response.ok) {
        const result = await response.json();
        // Save token in localStorage
        localStorage.setItem('authToken', result.token);

        message.style.color = 'green';
        message.textContent = 'Login successful! Redirecting...';
        setTimeout(() => {
          window.location.href = '/dashboard/';
        }, 1000);
      } else {
        const err = await response.json();
        message.style.color = 'red';
        message.textContent = 'Invalid email or password';
      }
    } catch (error) {
      message.style.color = 'red';
      message.textContent = 'An error occurred.';
    }
  });
</script>


</div>
{% endblock %}